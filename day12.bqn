u←•Import "util.bqn"
x←>u.Lines u.GetContents @
r←⊐⌾⥊ (⊢⌈((»˘⊸=x)×»˘)⌈((«˘⊸=x)×«˘)⌈((=⟜»x)×»)⌈((«⊸=x)×«))⍟(2×≠x) 1+(↕≠)⌾⥊x
•Show {z←∾⟜¯1{𝔽˘𝔽˘⌾⍉}r ⋄ +´{×○(+´∘⥊)⟜((⊢≠»)+(⊢≠»˘)) z=𝕩} ¨ ↕1+⌈´⥊r}
C1←∧⟜(¬»˘∨») ⋄ C2←∧⟜((»˘∧»∧(¬(»˘»)))) ⋄ _f←{𝔽+𝔽⌾(⌽∘⍉)+𝔽⌾⌽+𝔽⌾(⌽∘⍉∘⌽)}
•Show +´{×○(+´∘⥊)⟜(C1 _f+C2 _f) r=𝕩}¨↕1+⌈´⥊r
